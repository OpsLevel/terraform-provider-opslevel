name: Changie Gen

on:
  workflow_run:
    workflows: [Dependabot Labels]
    types:
      - completed

jobs:
  generate-changelog:
    runs-on: ubuntu-latest
    steps:
    - name: Create and commit changelog on bot PR
      if: github.event.workflow_run.conclusion == 'success'
      id: bot_changelog
      uses: emmyoop/changie_bot@v1.1.0
      with:
        GITHUB_TOKEN: ${{ secrets.ORG_GITHUB_TOKEN }}
        commit_author_name: "Github Build Bot"
        commit_author_email: "<bots@opslevel.com>"
        commit_message: "Add automated changelog yaml from template for bot PR"
        changie_kind: Dependency
        label: dependencies
